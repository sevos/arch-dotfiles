#!/bin/bash
# Niri session wrapper script

# Source user profile for environment variables
if [ -f "$HOME/.profile" ]; then
    . "$HOME/.profile"
fi

# Unset DISPLAY to prevent niri from trying to connect to X11
unset DISPLAY

# Set XDG session type
export XDG_SESSION_TYPE=wayland
export XDG_SESSION_DESKTOP=niri
export XDG_CURRENT_DESKTOP=niri

# Start GNOME Keyring daemon for Secret Service API (without SSH agent)
if command -v gnome-keyring-daemon >/dev/null 2>&1; then
    eval "$(gnome-keyring-daemon --start --components=secrets)"
    export SSH_AUTH_SOCK  # Keep 1Password SSH agent
fi

# Start niri with session management
exec niri --session